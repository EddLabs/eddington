[tox]
envlist = static,test_static,clean,py37,unit_tests,fitting_tests,report

[testenv]
setenv = PYTHONPATH = {toxinidir}/src
depends =
    test_static: static
    {py37}: clean
    unit_test: py37
    report: py37

[testenv:static]
pip_pre = true
deps = eddington-static
skip_install = true
commands =
    eddington-static src --filter fast

[testenv:test_static]
pip_pre = true
deps = eddington-static
skip_install = true
commands =
    eddington-static tests --filter test fast

[testenv:unit_tests]
deps =
    eddington-test
    pytest
    pytest-cov
    mock
commands = pytest --cov --cov-append --junitxml=test_results/test_junit.xml tests

[testenv:fitting_tests]
deps =
    eddington-test
    pytest
commands = pytest --junitxml=test_results/integration_junit.xml fitting_tests

[testenv:report]
deps = coverage
skip_install = true
commands =
    coverage report --fail-under=92
    coverage html

[testenv:clean]
deps = coverage
skip_install = true
commands = coverage erase